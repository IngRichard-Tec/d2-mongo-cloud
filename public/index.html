<!DOCTYPE html>
<html>
<head>
    <title>Gestión de Usuarios</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        .container { background: white; padding: 20px; border-radius: 8px; }
        input { display: block; margin-bottom: 10px; padding: 8px; width: 200px; }
        button { cursor: pointer; background: #0070f3; color: white; border: none; padding: 10px; border-radius: 5px; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Crear Usuario</h2>
        <input type="text" id="nombre" placeholder="Nombre">
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button onclick="guardar()">Guardar Usuario</button>

        <table id="tablaUsuarios">
            <thead>
                <tr><th>Nombre</th><th>Email</th><th>Acciones</th></tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        // Función para guardar (POST)
        async function guardar() {
            const data = {
                nombre: document.getElementById('nombre').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
            };
            await fetch('/api/usuarios', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
            location.reload();
        }

        // Función para cargar y mostrar (GET)
        async function cargar() {
            const res = await fetch('/api/usuarios');
            const usuarios = await res.json();
            const tabla = document.querySelector('#tablaUsuarios tbody');
            usuarios.forEach(u => {
                tabla.innerHTML += `
                    <tr>
                        <td>${u.nombre}</td>
                        <td>${u.email}</td>
                        <td><button onclick="eliminar('${u._id}')" style="background:red">X</button></td>
                    </tr>`;
            });
        }

        async function eliminar(id) {
            await fetch(`/api/usuarios/${id}`, { method: 'DELETE' });
            location.reload();
        }

        window.onload = cargar;
    </script>
</body>
</html>